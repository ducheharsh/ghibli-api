<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ghibli Landscapes API - Documentation</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="icon" href="{{ url_for('static', filename='img/favicon.ico') }}" type="image/x-icon">
</head>
<body class="api-docs">
    <header>
        <nav>
            <div class="logo">
                <img src="{{ url_for('static', filename='img/logo.png') }}" alt="Ghibli Landscapes">
                <h1>Ghibli Landscapes</h1>
            </div>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/api" class="active">API Docs</a></li>
                <li><a href="https://www.ghibli.jp/works/" target="_blank">Official Ghibli</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="api-header">
            <h1>Ghibli Landscapes API Documentation</h1>
            <p>Version: {{ api_version }}</p>
            <p>A simple API for accessing beautiful landscape images from Studio Ghibli films</p>
            <p class="stats">{{ image_count }} images from {{ film_count }} films</p>
        </section>

        <section class="api-overview">
            <h2>Overview</h2>
            <p>This API provides random Studio Ghibli landscape images from the official Ghibli website. It ensures that the same image is returned for the same ID or query, making it consistent across requests.</p>
            
            <h3>Features</h3>
            <ul>
                <li>Random Ghibli landscape images</li>
                <li>Consistent image selection based on query or ID</li>
                <li>Film-specific image retrieval</li>
                <li>Direct image redirects</li>
            </ul>
        </section>

        <section class="api-endpoints">
            <h2>API Endpoints</h2>
            
            <div class="endpoint">
                <h3>Home</h3>
                <div class="endpoint-details">
                    <p><strong>URL:</strong> <code>/</code></p>
                    <p><strong>Method:</strong> GET</p>
                    <p><strong>Description:</strong> Returns API information and available endpoints</p>
                    <p><strong>Response:</strong> JSON with API details</p>
                </div>
                <div class="endpoint-example">
                    <a href="/" class="btn secondary" target="_blank">Try it</a>
                </div>
            </div>

            <div class="endpoint">
                <h3>Random Image</h3>
                <div class="endpoint-details">
                    <p><strong>URL:</strong> <code>/api/random</code></p>
                    <p><strong>Method:</strong> GET</p>
                    <p><strong>Description:</strong> Returns a random Ghibli landscape image</p>
                    <p><strong>Response:</strong> JSON with image details</p>
                </div>
                <div class="endpoint-example">
                    <a href="/api/random" class="btn secondary" target="_blank">Try it</a>
                </div>
            </div>

            <div class="endpoint">
                <h3>Image by ID or Query</h3>
                <div class="endpoint-details">
                    <p><strong>URL:</strong> <code>/api/image</code></p>
                    <p><strong>Method:</strong> GET</p>
                    <p><strong>Parameters:</strong></p>
                    <ul>
                        <li><code>id</code> (optional): Specific image ID</li>
                        <li><code>q</code> (optional): Query string (same query always returns same image)</li>
                    </ul>
                    <p><strong>Description:</strong> Returns an image based on ID or query</p>
                    <p><strong>Response:</strong> JSON with image details</p>
                </div>
                <div class="endpoint-example">
                    <a href="/api/image?q=totoro" class="btn secondary" target="_blank">Try with query</a>
                </div>
            </div>

            <div class="endpoint">
                <h3>List Films</h3>
                <div class="endpoint-details">
                    <p><strong>URL:</strong> <code>/api/films</code></p>
                    <p><strong>Method:</strong> GET</p>
                    <p><strong>Description:</strong> Lists all available film codes</p>
                    <p><strong>Response:</strong> JSON with film codes</p>
                </div>
                <div class="endpoint-example">
                    <a href="/api/films" class="btn secondary" target="_blank">Try it</a>
                </div>
            </div>

            <div class="endpoint">
                <h3>Film-specific Image</h3>
                <div class="endpoint-details">
                    <p><strong>URL:</strong> <code>/api/film/{film_code}</code></p>
                    <p><strong>Method:</strong> GET</p>
                    <p><strong>Parameters:</strong></p>
                    <ul>
                        <li><code>film_code</code>: Code of the film (e.g., "totoro", "chihiro")</li>
                    </ul>
                    <p><strong>Description:</strong> Returns a random image from a specific film</p>
                    <p><strong>Response:</strong> JSON with image details</p>
                </div>
                <div class="endpoint-example">
                    <a href="/api/film/totoro" class="btn secondary" target="_blank">Try with Totoro</a>
                </div>
            </div>

            <div class="endpoint">
                <h3>Direct Image Redirects</h3>
                <div class="endpoint-details">
                    <p><strong>URL:</strong> <code>/api/redirect/random</code></p>
                    <p><strong>Method:</strong> GET</p>
                    <p><strong>Description:</strong> Redirects to a random image</p>
                    <p><strong>Response:</strong> HTTP redirect to image URL</p>
                </div>
                <div class="endpoint-example">
                    <a href="/api/redirect/random" class="btn secondary" target="_blank">Try it</a>
                </div>
            </div>

            <div class="endpoint">
                <h3>Direct Image Redirect by ID or Query</h3>
                <div class="endpoint-details">
                    <p><strong>URL:</strong> <code>/api/redirect</code></p>
                    <p><strong>Method:</strong> GET</p>
                    <p><strong>Parameters:</strong></p>
                    <ul>
                        <li><code>id</code> (optional): Specific image ID</li>
                        <li><code>q</code> (optional): Query string</li>
                    </ul>
                    <p><strong>Description:</strong> Redirects to an image based on ID or query</p>
                    <p><strong>Response:</strong> HTTP redirect to image URL</p>
                </div>
                <div class="endpoint-example">
                    <a href="/api/redirect?q=spirited away" class="btn secondary" target="_blank">Try with query</a>
                </div>
            </div>
        </section>

        <section class="api-response">
            <h2>Response Format</h2>
            <pre><code>{
  "id": "abcdef1234567890",
  "url": "https://www.ghibli.jp/gallery/totoro001.jpg",
  "film_code": "totoro",
  "film_name": "totoro",
  "image_number": "001"
}</code></pre>
        </section>

        <section class="api-usage">
            <h2>Usage Examples</h2>
            
            <div class="code-example">
                <h3>JavaScript Example</h3>
                <pre><code>// Get a random Ghibli landscape
fetch('/api/random')
  .then(response => response.json())
  .then(data => {
    console.log(data);
    document.getElementById('image').src = data.url;
  });</code></pre>
            </div>
            
            <div class="code-example">
                <h3>Python Example</h3>
                <pre><code>import requests

# Get an image based on a query
response = requests.get('https://your-domain.com/api/image', params={'q': 'totoro'})
data = response.json()
print(f"Image URL: {data['url']}")
print(f"Film: {data['film_code']}")</code></pre>
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-info">
                <h3>Ghibli Landscapes API</h3>
                <p>A collection of beautiful landscape images from Studio Ghibli films</p>
                <p>Images sourced from <a href="https://www.ghibli.jp/works/" target="_blank">www.ghibli.jp</a></p>
            </div>
            <div class="footer-links">
                <h3>Links</h3>
                <ul>
                    <li><a href="/">Home</a></li>
                    <li><a href="/api">API Documentation</a></li>
                    <li><a href="https://www.ghibli.jp/" target="_blank">Official Studio Ghibli</a></li>
                </ul>
            </div>
            <div class="footer-api">
                <h3>API Endpoints</h3>
                <ul>
                    <li><a href="/api/random" target="_blank">/api/random</a></li>
                    <li><a href="/api/films" target="_blank">/api/films</a></li>
                    <li><a href="/api/redirect/random" target="_blank">/api/redirect/random</a></li>
                </ul>
            </div>
        </div>
        <div class="copyright">
            <p>&copy; 2025 Ghibli Landscapes API. This is a fan project and is not affiliated with Studio Ghibli.</p>
        </div>
    </footer>
</body>
</html>
